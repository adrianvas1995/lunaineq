<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Relative index of inequality (two input modes) — rii_luna • lunaineq: Tools for Analyzing Health Inequality Metrics</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Relative index of inequality (two input modes) — rii_luna"><meta name="description" content="Computes the Relative Index of Inequality (RII) between the extreme social groups defined based on a
numeric equity stratifier. The function operates in two modes: (Mode A) using a numerator and
denominator (health_numerator and health_denominator), which is the preferred
and most accurate method, as it relies directly on event counts;
and (Mode B) using an aggregated health indicator (health_indicator)
and population weights (population_weights), which approximates the index based on weighted group means.
The function also provides automatic interpretations of the results in
four languages: Spanish, English, French, and Portuguese."><meta property="og:description" content="Computes the Relative Index of Inequality (RII) between the extreme social groups defined based on a
numeric equity stratifier. The function operates in two modes: (Mode A) using a numerator and
denominator (health_numerator and health_denominator), which is the preferred
and most accurate method, as it relies directly on event counts;
and (Mode B) using an aggregated health indicator (health_indicator)
and population weights (population_weights), which approximates the index based on weighted group means.
The function also provides automatic interpretations of the results in
four languages: Spanish, English, French, and Portuguese."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">lunaineq: Tools for Analyzing Health Inequality Metrics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/adrianvas1995/lunaineq/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Relative index of inequality (two input modes)</h1>
      <small class="dont-index">Source: <a href="https://github.com/adrianvas1995/lunaineq/blob/HEAD/R/rii_luna.R" class="external-link"><code>R/rii_luna.R</code></a></small>
      <div class="d-none name"><code>rii_luna.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes the Relative Index of Inequality (RII) between the extreme social groups defined based on a
numeric equity stratifier. The function operates in two modes: <strong>(Mode A)</strong> using a numerator and
denominator (<code>health_numerator</code> and <code>health_denominator</code>), which is the preferred
and most accurate method, as it relies directly on event counts;
and <strong>(Mode B)</strong> using an aggregated health indicator (<code>health_indicator</code>)
and population weights (<code>population_weights</code>), which approximates the index based on weighted group means.
The function also provides automatic interpretations of the results in
four languages: Spanish, English, French, and Portuguese.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">rii_luna</span><span class="op">(</span></span>
<span>  health_indicator_type <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  health_indicator <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  population_weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  health_numerator <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  health_denominator <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  equity_stratifier <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  higher_ineq_is_favorable <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rate_scaling_factor <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  models <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  model_evaluation_metric <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  conf_level <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  language_interpretation <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-health-indicator-type">health_indicator_type<a class="anchor" aria-label="anchor" href="#arg-health-indicator-type"></a></dt>
<dd><p>Character string: either <code>"proportion"</code> for bounded indicators in \([0,1]\), or <code>"rate"</code> if already scaled (e.g., deaths per 100,000); required in all cases.</p></dd>


<dt id="arg-health-indicator">health_indicator<a class="anchor" aria-label="anchor" href="#arg-health-indicator"></a></dt>
<dd><p>Numeric vector with the health indicator values (e.g., <code>c(0.12, 0.34)</code> for proportions or <code>c(120, 345)</code> for rates); aggregated value per unit; used only in Mode B.</p></dd>


<dt id="arg-population-weights">population_weights<a class="anchor" aria-label="anchor" href="#arg-population-weights"></a></dt>
<dd><p>Numeric vector &gt; 0 representing population size or weight per unit (e.g., <code>c(1000, 5000, 1200)</code>); used only in Mode B.</p></dd>


<dt id="arg-health-numerator">health_numerator<a class="anchor" aria-label="anchor" href="#arg-health-numerator"></a></dt>
<dd><p>Numeric vector with event counts (e.g., <code>c(5, 12, 8)</code> for deaths); used only in Mode A and preferred for robust estimation.</p></dd>


<dt id="arg-health-denominator">health_denominator<a class="anchor" aria-label="anchor" href="#arg-health-denominator"></a></dt>
<dd><p>Numeric vector &gt; 0 associated with <code>health_numerator</code> (e.g., <code>c(500, 1000, 800)</code> representing population at risk); used only in Mode A.</p></dd>


<dt id="arg-equity-stratifier">equity_stratifier<a class="anchor" aria-label="anchor" href="#arg-equity-stratifier"></a></dt>
<dd><p>Numeric vector representing the social stratifier (e.g., poverty rate, education index); required in all cases.</p></dd>


<dt id="arg-higher-ineq-is-favorable">higher_ineq_is_favorable<a class="anchor" aria-label="anchor" href="#arg-higher-ineq-is-favorable"></a></dt>
<dd><p>Logical; <code>TRUE</code> if higher values of <code>equity_stratifier</code> indicate better social conditions (e.g., Gross Domestic Product per capita), or <code>FALSE</code> if they indicate worse conditions (e.g., Unsatisfied Basic Needs).</p></dd>


<dt id="arg-rate-scaling-factor">rate_scaling_factor<a class="anchor" aria-label="anchor" href="#arg-rate-scaling-factor"></a></dt>
<dd><p>Numeric scalar &gt; 0 applied only when <code>health_indicator_type = "rate"</code>; commonly <code>1000</code> or <code>100000</code> (e.g., maternal mortality ratio per 100000 live births).</p></dd>


<dt id="arg-models">models<a class="anchor" aria-label="anchor" href="#arg-models"></a></dt>
<dd><p>Character vector specifying the regression models to evaluate; for proportions: default is <code>c("binomial", "linear logit(y)")</code> (Mode A) and <code>c("quasibinomial", "linear logit(y)")</code> (Mode B), allowed models include <code>"linear"</code>, <code>"linear ln(y)"</code>, <code>"linear logit(y)"</code>, <code>"binomial"</code>, <code>"quasibinomial"</code>; for rates: default is <code>c("poisson", "negative binomial")</code> (Mode A) and <code>c("linear ln(y)")</code> (Mode B), allowed models include <code>"linear"</code>, <code>"linear ln(y)"</code>, <code>"poisson"</code>, <code>"negative binomial"</code>.</p></dd>


<dt id="arg-model-evaluation-metric">model_evaluation_metric<a class="anchor" aria-label="anchor" href="#arg-model-evaluation-metric"></a></dt>
<dd><p>Character string defining the metric for best model selection; allowed values: <code>"MAE"</code>, <code>"MSE"</code>, <code>"RMSE"</code>, <code>"MAPE"</code>, <code>"AIC"</code>; default is <code>"MSE"</code>.</p></dd>


<dt id="arg-conf-level">conf_level<a class="anchor" aria-label="anchor" href="#arg-conf-level"></a></dt>
<dd><p>Numeric scalar between 0 and 1 (e.g., <code>0.95</code>) specifying the confidence level for inequality estimates; default is <code>0.95</code>.</p></dd>


<dt id="arg-language-interpretation">language_interpretation<a class="anchor" aria-label="anchor" href="#arg-language-interpretation"></a></dt>
<dd><p>Character string indicating the desired output language for interpretation and note; allowed values are <code>"en"</code>, <code>"es"</code>, <code>"fr"</code>, <code>"pt"</code> or full names (<code>"english"</code>, <code>"spanish"</code>, <code>"french"</code>, <code>"portuguese"</code>); default is <code>"en"</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>list</code> with components:</p>
<dl><dt>summary_table</dt>
<dd><p>A <code>tibble</code> with <code>inequality_metric</code>, <code>selected_model</code>, <code>estimate</code>, <code>ci_lower</code>, <code>ci_upper</code>.</p></dd>

<dt>interpretation</dt>
<dd><p>Character: automatic interpretation in the selected language.</p></dd>

<dt>note</dt>
<dd><p>Character: explanatory note/alerts in the selected language.</p></dd>

<dt>global_health_mean</dt>
<dd><p>Numeric: overall mean of the health indicator (weighted or derived from num/den).</p></dd>

<dt>data</dt>
<dd><p><code>tibble</code> used for calculations. Contains at least: <code>health_indicator</code>, <code>equity_stratifier</code>, <code>pop_use</code>, <code>social_position</code> (ridit), fitted prediction columns for candidate models, and <code>final_model_pred</code>.</p></dd>

<dt>data_with_extremes</dt>
<dd><p>A <code>data.frame</code> / <code>tibble</code> that appends the extreme social positions (0 and 1) and their predicted values (from emmeans). Useful for plotting extremes.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>In both cases, the social stratifier is transformed into a relative social position (ridit)
ranging from 0 (most disadvantaged) to 1 (most advantaged), ensuring that <em>position 0</em>
corresponds to the most disadvantaged and <em>position 1</em> to the most advantaged
(as defined by <code>higher_ineq_is_favorable</code>). The RII is calculated as the relative difference in the health indicator \(y\)
—predicted from the regression model at the two extremes— between the most disadvantaged and the most advantaged positions: \(\mathrm{RII} = \hat{y}_{\text{advantaged}} / \hat{y}_{\text{disadvantaged}}\).</p>
<div class="section">
<h3 id="a-using-numerator-and-denominator-preferred-">A) Using numerator and denominator (preferred)<a class="anchor" aria-label="anchor" href="#a-using-numerator-and-denominator-preferred-"></a></h3>
<p>This method calculates the health indicator directly from event counts and denominators, ensuring statistical robustness.</p>
<ul><li><p><strong>Proportions</strong>: The RII is computed using binomial, linear or logit-linear regression models.</p></li>
<li><p><strong>Rates</strong>: The RII is estimated from Poisson, negative binomial, or log-linear regression models, scaled by <code>rate_scaling_factor</code>.</p></li>
<li><p><em>This mode does not require population weights</em>: estimates are based on observed event counts.</p></li>
</ul></div>

<div class="section">
<h3 id="b-using-aggregated-indicator-and-population-weights-approximate-">B) Using aggregated indicator and population weights (approximate)<a class="anchor" aria-label="anchor" href="#b-using-aggregated-indicator-and-population-weights-approximate-"></a></h3>
<p>This method approximates the RII based on weighted means.</p>
<ul><li><p><strong>Proportions</strong>: Quasibinomial or logit-linear models are used.</p></li>
<li><p><strong>Rates</strong>: Linear or log-linear regression models with weights are applied.</p></li>
<li><p><em>Warning</em>: Results may be biased when using small samples or aggregated data. Prefer Mode A when possible.</p></li>
</ul></div>

    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Mode B is designed for cases where only summary indicators and population weights are available. However, Mode A should be used whenever individual counts are accessible, as it yields more accurate and robust estimates.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>World Health Organization. Handbook on health inequality monitoring with a special focus on low- and middle-income countries. 2013.
Available from: https://www.who.int/publications/i/item/9789241548632</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rvlenth.github.io/emmeans/reference/emmeans.html" class="external-link">emmeans::emmeans</a></code>, <code><a href="https://sandwich.R-Forge.R-project.org/reference/vcovHC.html" class="external-link">sandwich::vcovHC</a></code>, <code><a href="https://rdrr.io/pkg/Metrics/man/mae.html" class="external-link">Metrics::mae</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Adrián Vázquez-Mejía, MD MSc(c) (<a href="mailto:apvasquez.md@gmail.com">apvasquez.md@gmail.com</a>)
<br> Independent Consultant</p>
<p>Oscar J. Mújica, MD MPH (<a href="mailto:mujicaos@paho.org">mujicaos@paho.org</a>)
<br> Pan American Health Organization (PAHO), Washington D.C.</p>
<p>Antonio Sanhueza, PhD (<a href="mailto:sanhueza@paho.org">sanhueza@paho.org</a>)
<br> Pan American Health Organization (PAHO), Washington D.C.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># ——— Mode A (preferred: numerator and denominator) ———</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example with a rate indicator (e.g., maternal mortality ratio)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">data1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">rii_luna</span><span class="op">(</span></span></span>
<span class="r-in"><span>  health_indicator_type    <span class="op">=</span> <span class="st">"rate"</span>,</span></span>
<span class="r-in"><span>  health_numerator         <span class="op">=</span> <span class="va">data1</span><span class="op">$</span><span class="va">maternal_deaths</span>,</span></span>
<span class="r-in"><span>  health_denominator       <span class="op">=</span> <span class="va">data1</span><span class="op">$</span><span class="va">live_births</span>,</span></span>
<span class="r-in"><span>  equity_stratifier        <span class="op">=</span> <span class="va">data1</span><span class="op">$</span><span class="va">ubn_percent</span>,</span></span>
<span class="r-in"><span>  higher_ineq_is_favorable <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  rate_scaling_factor      <span class="op">=</span> <span class="fl">100000</span>,</span></span>
<span class="r-in"><span>  models <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'poisson'</span>, <span class="st">'negative binomial'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  model_evaluation_metric <span class="op">=</span> <span class="st">'MSE'</span>,</span></span>
<span class="r-in"><span>  conf_level               <span class="op">=</span> <span class="fl">0.95</span>,</span></span>
<span class="r-in"><span>  language_interpretation  <span class="op">=</span> <span class="st">"en"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $summary_table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    inequality_metric    selected_model  estimate  ci_lower</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Relative index of inequality (RII) negative binomial 0.3602192 0.2401015</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    ci_upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.5404293</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interpretation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "The Relative Index of Inequality is 36.02%, 95%CI [24.01%; 54.04%]. This means that the Health Indicator is higher in the most disadvantaged group. In relative terms, the most advantaged group has 36.02% of the number of events per 100,000 individuals in the reference population compared to the most disadvantaged group. Moreover, this relationship is statistically significant."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $note</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Note: Events correspond to the numerator and the base population to the denominator. The disadvantaged extreme = posicion_social 0; advantaged = 1."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $global_health_mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 78.58214</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 25 × 12</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    health_indicator equity_stratifier health_numerator health_denominator</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>            125.               60.3               34              <span style="text-decoration: underline;">27</span>183</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>            118.               50                 15              <span style="text-decoration: underline;">12</span>713</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>            134.               48.4                8               <span style="text-decoration: underline;">5</span>975</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>             89.5              40                 17              <span style="text-decoration: underline;">18</span>992</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>            106.               37.5               11              <span style="text-decoration: underline;">10</span>357</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>            107.               33.2               12              <span style="text-decoration: underline;">11</span>210</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>             72.3              31.7               11              <span style="text-decoration: underline;">15</span>214</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>             66.7              29.6                3               <span style="text-decoration: underline;">4</span>497</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>            118.               29.4               39              <span style="text-decoration: underline;">32</span>938</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>            164.               29.4                4               <span style="text-decoration: underline;">2</span>433</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 15 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 8 more variables: equity_stratifier_order &lt;dbl&gt;, pop_use &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   social_position &lt;dbl&gt;, pred_model_poisson &lt;dbl&gt;, pred_model_negbin &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   pred_model_linear &lt;dbl&gt;, pred_model_linear_lny &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   final_model_pred &lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data_with_extremes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    social_position health_indicator final_model_pred</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       0.00000000               NA        126.05426</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       0.02394729        125.07817        123.00946</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       0.05909430        117.98946        118.67334</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       0.07555778        133.89121        116.69513</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       0.09755285         89.51137        114.10361</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6       0.12340832        106.20836        111.13074</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7       0.14240810        107.04728        108.99563</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8       0.16568674         72.30183        106.43551</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9       0.18305145         66.71114        104.56503</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10      0.21817379        118.40427        100.88162</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11      0.21817379        164.40608        100.88162</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12      0.28203676         88.89847         94.51334</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13      0.33072244         77.16475         89.92993</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14      0.37190583        118.86034         86.22678</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15      0.41799883         84.33125         82.26271</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16      0.44774640         39.79704         79.80167</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17      0.47986112         90.89876         77.22737</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18      0.52331123         78.54088         73.87611</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19      0.56427966         72.07666         70.84958</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20      0.61704950        101.88908         67.13320</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21      0.66856221         49.64123         63.69347</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22      0.70297537         35.49456         61.49432</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23      0.72030044         72.41130         60.41607</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24      0.72768734         53.35230         59.96211</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25      0.85191584         42.83889         52.81896</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26      0.98559533         67.27417         46.07994</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27      1.00000000               NA         45.40717</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example with a proportion indicator (e.g., skilled birth attendance)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">data2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">rii_luna</span><span class="op">(</span></span></span>
<span class="r-in"><span>  health_numerator         <span class="op">=</span> <span class="va">data2</span><span class="op">$</span><span class="va">skilled_births</span>,</span></span>
<span class="r-in"><span>  health_denominator       <span class="op">=</span> <span class="va">data2</span><span class="op">$</span><span class="va">total_births</span>,</span></span>
<span class="r-in"><span>  equity_stratifier        <span class="op">=</span> <span class="va">data2</span><span class="op">$</span><span class="va">ubn_percent</span>,</span></span>
<span class="r-in"><span>  higher_ineq_is_favorable <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  health_indicator_type    <span class="op">=</span> <span class="st">"proportion"</span>,</span></span>
<span class="r-in"><span>  models <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'binomial'</span>, <span class="st">'linear logit(y)'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  model_evaluation_metric <span class="op">=</span> <span class="st">'MSE'</span>,</span></span>
<span class="r-in"><span>  conf_level               <span class="op">=</span> <span class="fl">0.95</span>,</span></span>
<span class="r-in"><span>  language_interpretation  <span class="op">=</span> <span class="st">"en"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $summary_table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    inequality_metric selected_model estimate ci_lower ci_upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Relative index of inequality (RII)       binomial 1.558146 1.292264 1.878735</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interpretation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "The Relative Index of Inequality is 1.56, 95%CI [1.29; 1.88]. This means that the Health Indicator is higher in the most advantaged group. In relative terms, the value in the most advantaged group is 1.56 times that of the most disadvantaged group. Moreover, this relationship is statistically significant."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $note</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Note: Indicator expressed as proportions (0–1). The disadvantaged extreme = posicion_social 0; advantaged = 1."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $global_health_mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.8711922</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 25 × 13</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    health_indicator equity_stratifier health_numerator health_denominator</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>            0.568              60.3            <span style="text-decoration: underline;">15</span>440              <span style="text-decoration: underline;">27</span>183</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>            0.774              50               <span style="text-decoration: underline;">9</span>840              <span style="text-decoration: underline;">12</span>713</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>            0.878              48.4             <span style="text-decoration: underline;">5</span>246               <span style="text-decoration: underline;">5</span>975</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>            0.839              40              <span style="text-decoration: underline;">15</span>934              <span style="text-decoration: underline;">18</span>992</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>            0.613              37.5             <span style="text-decoration: underline;">6</span>349              <span style="text-decoration: underline;">10</span>357</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>            0.805              33.2             <span style="text-decoration: underline;">9</span>024              <span style="text-decoration: underline;">11</span>210</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>            0.918              31.7            <span style="text-decoration: underline;">13</span>966              <span style="text-decoration: underline;">15</span>214</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>            0.975              29.6             <span style="text-decoration: underline;">4</span>385               <span style="text-decoration: underline;">4</span>497</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>            0.658              29.4            <span style="text-decoration: underline;">21</span>673              <span style="text-decoration: underline;">32</span>938</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>            0.932              29.4             <span style="text-decoration: underline;">2</span>268               <span style="text-decoration: underline;">2</span>433</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 15 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 9 more variables: equity_stratifier_order &lt;dbl&gt;, pop_use &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   social_position &lt;dbl&gt;, pred_model_binomial &lt;dbl&gt;, pred_model_quasi &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   pred_model_linear &lt;dbl&gt;, pred_model_linear_lny &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   pred_model_linear_logit &lt;dbl&gt;, final_model_pred &lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data_with_extremes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    social_position health_indicator final_model_pred</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       0.00000000               NA        0.6298794</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       0.02394729        0.5680021        0.6488517</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       0.05909430        0.7740109        0.6758533</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       0.07555778        0.8779916        0.6881228</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       0.09755285        0.8389848        0.7041096</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6       0.12340832        0.6130154        0.7222798</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7       0.14240810        0.8049955        0.7351853</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8       0.16568674        0.9179703        0.7504644</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9       0.18305145        0.9750945        0.7614717</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10      0.21817379        0.6579938        0.7826990</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11      0.21817379        0.9321825        0.7826990</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12      0.28203676        0.8039923        0.8177136</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13      0.33072244        0.9280163        0.8413416</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14      0.37190583        0.7459885        0.8593344</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15      0.41799883        0.8449992        0.8774148</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16      0.44774640        0.9740324        0.8879931</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17      0.47986112        0.9409916        0.8985090</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18      0.52331123        0.8879920        0.9113382</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19      0.56427966        0.8720003        0.9220747</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20      0.61704950        0.8509941        0.9341478</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21      0.66856221        0.9410172        0.9442360</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22      0.70297537        0.9920137        0.9501457</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23      0.72030044        0.9551050        0.9528916</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24      0.72768734        0.9800818        0.9540181</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25      0.85191584        0.9883966        0.9695088</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26      0.98559533        0.9920494        0.9805210</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27      1.00000000               NA        0.9814444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ——— Mode B (aggregated indicator + population as weight) ———</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example with rate indicator</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">data1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">rii_luna</span><span class="op">(</span></span></span>
<span class="r-in"><span>  health_indicator         <span class="op">=</span> <span class="va">data1</span><span class="op">$</span><span class="va">mmr</span>,</span></span>
<span class="r-in"><span>  equity_stratifier        <span class="op">=</span> <span class="va">data1</span><span class="op">$</span><span class="va">ubn_percent</span>,</span></span>
<span class="r-in"><span>  population_weights       <span class="op">=</span> <span class="va">data1</span><span class="op">$</span><span class="va">population_zone</span>,</span></span>
<span class="r-in"><span>  higher_ineq_is_favorable <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  health_indicator_type    <span class="op">=</span> <span class="st">"rate"</span>,</span></span>
<span class="r-in"><span>  models <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'linear ln(y)'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  model_evaluation_metric <span class="op">=</span> <span class="st">'MSE'</span>,</span></span>
<span class="r-in"><span>  rate_scaling_factor      <span class="op">=</span> <span class="fl">100000</span>,</span></span>
<span class="r-in"><span>  conf_level               <span class="op">=</span> <span class="fl">0.95</span>,</span></span>
<span class="r-in"><span>  language_interpretation  <span class="op">=</span> <span class="st">"en"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $summary_table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    inequality_metric selected_model  estimate  ci_lower</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Relative index of inequality (RII)   linear ln(y) 0.3197676 0.2169331</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    ci_upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.4713494</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interpretation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "The Relative Index of Inequality is 31.98%, 95%CI [21.69%; 47.13%]. This means that the Health Indicator is higher in the most disadvantaged group. In relative terms, the most advantaged group has 31.98% of the number of events per 100,000 individuals in the reference population compared to the most disadvantaged group. Moreover, this relationship is statistically significant."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $note</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Note: Events correspond to the numerator and the base population to the denominator. The disadvantaged extreme = posicion_social 0; advantaged = 1."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $global_health_mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 78.63539</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 25 × 11</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    health_indicator equity_stratifier population_weights equity_stratifier_order</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>            125.               60.3              <span style="text-decoration: underline;">27</span>019                   -<span style="color: #BB0000;">60.3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>            118.               50                <span style="text-decoration: underline;">12</span>620                   -<span style="color: #BB0000;">50</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>            134.               48.4               <span style="text-decoration: underline;">5</span>920                   -<span style="color: #BB0000;">48.4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>             89.5              40                <span style="text-decoration: underline;">18</span>864                   -<span style="color: #BB0000;">40</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>            106.               37.5              <span style="text-decoration: underline;">10</span>315                   -<span style="color: #BB0000;">37.5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>            107.               33.2              <span style="text-decoration: underline;">11</span>087                   -<span style="color: #BB0000;">33.2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>             72.3              31.7              <span style="text-decoration: underline;">15</span>106                   -<span style="color: #BB0000;">31.7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>             66.7              29.6               <span style="text-decoration: underline;">4</span>477                   -<span style="color: #BB0000;">29.6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>            118.               29.4              <span style="text-decoration: underline;">32</span>682                   -<span style="color: #BB0000;">29.4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>            164.               29.4               <span style="text-decoration: underline;">2</span>399                   -<span style="color: #BB0000;">29.4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 15 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 7 more variables: pop_use &lt;dbl&gt;, social_position &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   pred_model_poisson &lt;dbl&gt;, pred_model_negbin &lt;dbl&gt;, pred_model_linear &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   pred_model_linear_lny &lt;dbl&gt;, final_model_pred &lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data_with_extremes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    social_position health_indicator final_model_pred</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       0.00000000               NA        128.42651</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       0.02400413        125.07817        124.95932</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       0.05922008        117.98946        120.04137</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       0.07569132        133.89121        117.80804</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       0.09770984         89.51137        114.88733</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6       0.12363295        106.20836        111.54135</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7       0.14264684        107.04728        109.14928</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8       0.16591714         72.30183        106.29142</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9       0.18331500         66.71114        104.20376</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10      0.21845899        118.40427        100.11089</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11      0.21845899        164.40608        100.11089</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12      0.28231926         88.89847         93.08075</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13      0.33096718         77.16475         88.05847</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14      0.37224569        118.86034         84.01008</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15      0.41852775         84.33125         79.69189</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16      0.44839543         39.79704         77.02375</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17      0.48058632         90.89876         74.24802</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18      0.52409386         78.54088         70.65476</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19      0.56515026         72.07666         67.42356</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20      0.61802171        101.88908         63.47922</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21      0.66964316         49.64123         59.85086</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22      0.70409507         35.49456         57.54545</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23      0.72140587         72.41130         56.42081</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24      0.72881260         53.35230         55.94635</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25      0.85247397         42.83889         48.58910</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26      0.98558366         67.27417         41.74722</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27      1.00000000               NA         41.06663</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example with proportion indicator</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">data2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">rii_luna</span><span class="op">(</span></span></span>
<span class="r-in"><span>  health_indicator         <span class="op">=</span> <span class="va">data2</span><span class="op">$</span><span class="va">skilled_births_prop</span>,</span></span>
<span class="r-in"><span>  equity_stratifier        <span class="op">=</span> <span class="va">data2</span><span class="op">$</span><span class="va">ubn_percent</span>,</span></span>
<span class="r-in"><span>  population_weights       <span class="op">=</span> <span class="va">data2</span><span class="op">$</span><span class="va">population</span>,</span></span>
<span class="r-in"><span>  higher_ineq_is_favorable <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  health_indicator_type    <span class="op">=</span> <span class="st">"proportion"</span>,</span></span>
<span class="r-in"><span>  models <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'quasibinomial'</span>, <span class="st">'linear logit(y)'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  model_evaluation_metric <span class="op">=</span> <span class="st">'MSE'</span>,</span></span>
<span class="r-in"><span>  conf_level               <span class="op">=</span> <span class="fl">0.95</span>,</span></span>
<span class="r-in"><span>  language_interpretation  <span class="op">=</span> <span class="st">"en"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $summary_table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    inequality_metric selected_model estimate ci_lower ci_upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Relative index of inequality (RII)  quasibinomial 1.557972 1.291993 1.878706</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interpretation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "The Relative Index of Inequality is 1.56, 95%CI [1.29; 1.88]. This means that the Health Indicator is higher in the most advantaged group. In relative terms, the value in the most advantaged group is 1.56 times that of the most disadvantaged group. Moreover, this relationship is statistically significant."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $note</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Note: Indicator expressed as proportions (0–1). The disadvantaged extreme = posicion_social 0; advantaged = 1."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $global_health_mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.8709839</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 25 × 12</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    health_indicator equity_stratifier population_weights equity_stratifier_order</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>            0.568              60.3              <span style="text-decoration: underline;">27</span>019                   -<span style="color: #BB0000;">60.3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>            0.774              50                <span style="text-decoration: underline;">12</span>620                   -<span style="color: #BB0000;">50</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>            0.878              48.4               <span style="text-decoration: underline;">5</span>920                   -<span style="color: #BB0000;">48.4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>            0.839              40                <span style="text-decoration: underline;">18</span>864                   -<span style="color: #BB0000;">40</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>            0.613              37.5              <span style="text-decoration: underline;">10</span>315                   -<span style="color: #BB0000;">37.5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>            0.805              33.2              <span style="text-decoration: underline;">11</span>087                   -<span style="color: #BB0000;">33.2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>            0.918              31.7              <span style="text-decoration: underline;">15</span>106                   -<span style="color: #BB0000;">31.7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>            0.975              29.6               <span style="text-decoration: underline;">4</span>477                   -<span style="color: #BB0000;">29.6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>            0.658              29.4              <span style="text-decoration: underline;">32</span>682                   -<span style="color: #BB0000;">29.4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>            0.932              29.4               <span style="text-decoration: underline;">2</span>399                   -<span style="color: #BB0000;">29.4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 15 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 8 more variables: pop_use &lt;dbl&gt;, social_position &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   pred_model_binomial &lt;dbl&gt;, pred_model_quasi &lt;dbl&gt;, pred_model_linear &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   pred_model_linear_lny &lt;dbl&gt;, pred_model_linear_logit &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   final_model_pred &lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data_with_extremes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    social_position health_indicator final_model_pred</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       0.00000000               NA        0.6298757</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       0.02400413           0.5680        0.6488580</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       0.05922008           0.7740        0.6758624</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       0.07569132           0.8780        0.6881150</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       0.09770984           0.8390        0.7040898</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6       0.12363295           0.6130        0.7222744</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7       0.14264684           0.8050        0.7351661</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8       0.16591714           0.9180        0.7504129</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9       0.18331500           0.9751        0.7614225</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10      0.21845899           0.6580        0.7826278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11      0.21845899           0.9322        0.7826278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12      0.28231926           0.8040        0.8175895</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13      0.33096718           0.9280        0.8411719</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14      0.37224569           0.7460        0.8591887</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15      0.41852775           0.8450        0.8773236</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16      0.44839543           0.9740        0.8879309</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17      0.48058632           0.9410        0.8984573</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18      0.52409386           0.8880        0.9112861</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19      0.56515026           0.8720        0.9220314</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20      0.61802171           0.8510        0.9341116</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21      0.66964316           0.9410        0.9442075</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22      0.70409507           0.9920        0.9501160</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23      0.72140587           0.9551        0.9528563</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24      0.72881260           0.9801        0.9539846</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25      0.85247397           0.9884        0.9694053</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26      0.98558366           0.9920        0.9804004</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27      1.00000000               NA        0.9813284</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Adrián Vázquez-Mejía, Oscar J. Mújica, Antonio Sanhueza.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

